(this.webpackJsonpbadbank=this.webpackJsonpbadbank||[]).push([[0],{104:function(e,t,a){},105:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),c=a(34),r=a.n(c),i=(a(75),a(10)),o=a(8),l=a(26),d=a(39),j=a.n(d),u=a(62),b=(Object(u.a)({apiKey:"your info goes here",authDomain:"your info goes here",projectId:"your info goes here",storageBucket:"your info goes here",messagingSenderId:"your info goes here",appId:"your info goes here"}),a(2)),m=s.a.createContext(),h={users:[],currentUser:null,success:!1,showError:!1};function O(e,t){switch(t.type){case"SET_USERS":case"UPDATE_USERS":return Object(o.a)(Object(o.a)({},e),{},{users:t.payload});case"LOGIN":case"UPDATE_USER":return Object(o.a)(Object(o.a)({},e),{},{currentUser:t.payload});case"SET_SUCCESS":return Object(o.a)(Object(o.a)({},e),{},{success:t.payload});case"SET_ERROR":return Object(o.a)(Object(o.a)({},e),{},{error:t.payload})}}function x(e){var t=s.a.useReducer(O,h),a=Object(i.a)(t,2),c=a[0],r=a[1],o=function(e,t){var a=function(e){var a=Object(l.b)();if(!a.currentUser)return new Promise((function(e,t){t("No user logged in.")}));a.currentUser.getIdToken().then((function(a){return console.log("idToken:",a),j.a.get("http://localhost:3000/account/info/".concat(e),{headers:{Authorization:a}}).then((function(e){var a=e.data;t({type:"UPDATE_USER",payload:a})}))}))};return{addUser:function(e,a){var n=a.setShow,s=a.setShowSpinner,c=a.setShowErrorMessage,r=a.setErrorMessage,i=Object(l.b)();Object(l.a)(i,e.email,e.password).then((function(a){a.user.getIdToken().then((function(a){j.a.get("http://localhost:3000/account/create/".concat(e.name,"/").concat(e.email,"/").concat(e.password),{headers:{Authorization:a}}).then((function(a){t({type:"UPDATE_USER",payload:e}),n(!1),s(!1)})).catch((function(e){r("".concat(e.code," ").concat(e.message)),c(!0),s(!1)}))}))})).catch((function(e){r("".concat(e.code," ").concat(e.message)),c(!0),s(!1)}))},logIn:function(e,t){var a=t.setShowSpinner,n=t.setShowErrorMessage,s=t.setErrorMessage,c=Object(l.b)();Object(l.c)(c,e.email,e.password).then((function(e){a(!1)})).catch((function(e){s("".concat(e.code," ").concat(e.message)),n(!0),a(!1)}))},withdraw:function(t){var n=Object(l.b)();n.currentUser?n.currentUser.getIdToken().then((function(n){console.log("idToken:",n),j.a.get("http://localhost:3000/account/withdraw/".concat(e.currentUser.email,"/").concat(t),{headers:{Authorization:n}}).then((function(t){a(e.currentUser.email)}))})):console.error("user not logged in")},deposit:function(t){var n=Object(l.b)();n.currentUser?n.currentUser.getIdToken().then((function(n){console.log("idToken:",n),j.a.get("http://localhost:3000/account/deposit/".concat(e.currentUser.email,"/").concat(t),{headers:{Authorization:n}}).then((function(t){a(e.currentUser.email)}))})):console.error("user not logged in")},setSuccess:function(e){t({type:"SET_SUCCESS",payload:e})},setError:function(e){t({type:"SET_ERROR",payload:e})},getAllUsers:function(){j.a.get("http://localhost:3000/account/all").then((function(e){t({type:"SET_USERS",payload:e.data})})).catch((function(e){return console.log(e)}))},updateUser:function(e){t({type:"UPDATE_USER",payload:e})},signOut:function(){Object(l.b)().signOut()},getUserInfo:a}}(c,r),d={state:c,dispatch:r,actions:o};return Object(n.useEffect)((function(){Object(l.b)().onAuthStateChanged((function(e){e?o.getUserInfo(e.email):(o.updateUser(null),console.log("User is not logged in"))}))}),[]),Object(b.jsx)(m.Provider,{value:d,children:e.children})}var g=a(13);function p(){var e=Object(n.useContext)(m),t=e.state,a=e.actions,s=Object(g.e)();return Object(b.jsx)(b.Fragment,{children:Object(b.jsxs)("nav",{className:"navbar navbar-expand-lg navbar-light bg-light",children:[Object(b.jsx)("a",{className:"navbar-brand",href:"#",children:"BadBank"}),Object(b.jsx)("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation",children:Object(b.jsx)("span",{className:"navbar-toggler-icon"})}),Object(b.jsx)("div",{className:"collapse navbar-collapse",id:"navbarNav",children:Object(b.jsxs)("ul",{className:"navbar-nav",children:[Object(b.jsx)("li",{className:"nav-item",children:Object(b.jsx)("a",{className:"/CreateAccount/"===s.pathname?"nav-link active":"nav-link",href:"#/CreateAccount/",children:"Create Account"})}),Object(b.jsx)("li",{className:"nav-item",children:Object(b.jsx)("a",{className:"/login/"===s.pathname?"nav-link active":"nav-link",href:"#/login/","aria-label":"login-link",children:t.currentUser?"Profile":"Login"})}),t.currentUser&&Object(b.jsx)("li",{className:"nav-item",children:Object(b.jsx)("a",{className:"/deposit/"===s.pathname?"nav-link active":"nav-link",href:"#/deposit/",children:"Deposit"})}),t.currentUser&&Object(b.jsx)("li",{className:"nav-item",children:Object(b.jsx)("a",{className:"/withdraw/"===s.pathname?"nav-link active":"nav-link",href:"#/withdraw/",children:"Withdraw"})}),Object(b.jsx)("li",{className:"nav-item",children:Object(b.jsx)("a",{className:"/alldata/"===s.pathname?"nav-link active":"nav-link",href:"#/alldata/",children:"AllData"})}),t.currentUser&&Object(b.jsx)("li",{className:"nav-item",children:Object(b.jsx)("a",{className:"/login/"===s.pathname?"nav-link active":"nav-link",onClick:a.signOut,"aria-label":"login-link",children:"Logout"})})]})})]})})}var v=a(51);function f(e){return Object(b.jsxs)("div",{className:"card mb-3 "+(e.bgcolor?" bg-"+e.bgcolor:" ")+(e.txtcolor?" text-"+e.txtcolor:" text-white"),style:{maxWidth:"18rem"},children:[Object(b.jsx)("div",{className:"card-header",children:e.header}),Object(b.jsxs)("div",{className:"card-body",children:[e.title&&Object(b.jsx)("h5",{className:"card-title",children:e.title}),e.text&&Object(b.jsx)("p",{className:"card-text",children:e.text}),e.body,e.status&&Object(b.jsx)("div",{id:"createStatus",children:e.status})]})]})}function w(){return Object(b.jsx)(f,{bgcolor:"secondary",header:"Welcome to the bank",body:Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("p",{children:"For all your banking needs"}),Object(b.jsx)("div",{children:Object(b.jsx)("img",{src:"./bankicon.png",alt:"wat",width:"100%"})})]})})}var N=a(33);function S(e){return Object(b.jsx)("div",{style:{marginTop:"10px"},className:"alert alert-danger",role:"alert",children:e.message})}var y=a(107),E=a(108);function U(){var e=Object(n.useState)(!0),t=Object(i.a)(e,2),a=t[0],s=t[1],c=Object(n.useState)(!1),r=Object(i.a)(c,2),l=r[0],d=r[1],j=Object(n.useState)(!1),u=Object(i.a)(j,2),h=u[0],O=u[1],x=Object(n.useState)(""),g=Object(i.a)(x,2),p=g[0],v=g[1],w=Object(n.useContext)(m).actions,U=Object(N.a)({initialValues:{name:"",email:"",password:""},onSubmit:function(e){console.log(e),d(!0),w.addUser(Object(o.a)(Object(o.a)({},e),{},{balance:0}),{setShow:s,setShowSpinner:d,setShowErrorMessage:O,setErrorMessage:v})},onReset:function(e){s(!0)},validate:function(e){var t={};return e.name||(t.name="Field required"),e.email||(t.email="Field required"),/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e.email)||(t.email="Invalid Email"),e.password||(t.password="Field required"),e.password.length<8&&(t.password="Password needs to be more than 8 characters"),t}});return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("h3",{children:"CREATE ACCOUNT"}),Object(b.jsx)(f,{bgcolor:"primary",body:a?Object(b.jsxs)(b.Fragment,{children:[l&&Object(b.jsx)(y.a,{animation:"border",role:"status",children:Object(b.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),Object(b.jsxs)("form",{onSubmit:U.handleSubmit,children:["Name",Object(b.jsx)("br",{}),Object(b.jsx)("input",{type:"input",className:"form-control",id:"name",name:"name",placeholder:"Enter name",onChange:U.handleChange,value:U.values.name}),Object(b.jsx)("br",{}),U.errors.name?Object(b.jsx)(S,{message:U.errors.name}):null,"Email address",Object(b.jsx)("br",{}),Object(b.jsx)("input",{type:"input",className:"form-control",id:"email",name:"email",placeholder:"Enter email",onChange:U.handleChange,value:U.values.email}),Object(b.jsx)("br",{}),U.errors.email?Object(b.jsx)(S,{message:U.errors.email}):null,"Password",Object(b.jsx)("br",{}),Object(b.jsx)("input",{type:"password",className:"form-control",id:"password",name:"password",placeholder:"Enter password",onChange:U.handleChange,value:U.values.password}),Object(b.jsx)("br",{}),U.errors.password?Object(b.jsx)(S,{message:U.errors.password}):null,Object(b.jsx)("button",{type:"submit",className:"btn btn-light",id:"submitBtn",disabled:!(U.isValid&&U.dirty),children:"Create Account"})]}),Object(b.jsx)("br",{}),h&&Object(b.jsx)(E.a,{variant:"danger",children:p})]}):Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("h5",{children:"Success"}),Object(b.jsx)("button",{type:"submit",className:"btn btn-light",onClick:U.handleReset,children:"Add another account"})]})})]})}function C(){var e=Object(n.useContext)(m),t=e.state,a=e.actions,s=Object(n.useState)(!1),c=Object(i.a)(s,2),r=c[0],o=c[1],l=Object(n.useState)(!1),d=Object(i.a)(l,2),j=d[0],u=d[1],h=Object(n.useState)(""),O=Object(i.a)(h,2),x=O[0],g=O[1],p=Object(N.a)({initialValues:{email:"",password:""},onSubmit:function(e){o(!0),a.logIn(e,{setShowSpinner:o,setShowErrorMessage:u,setErrorMessage:g})},validate:function(e){var t={};return e.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e.email)||(t.email="Username should be an email"):t.email="Field required",e.password||(t.password="Field required"),t}});return Object(b.jsx)(f,{bgcolor:"primary",header:t.currentUser?"Profile":"Login",body:t.currentUser?Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{id:"login-message",children:"Login Succesful!"}),Object(b.jsx)("br",{})," Hello,",JSON.stringify(t.currentUser)]}):Object(b.jsxs)("div",{children:[r&&Object(b.jsx)(y.a,{animation:"border",role:"status",children:Object(b.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),Object(b.jsxs)("form",{onSubmit:p.handleSubmit,"data-testid":"login-form",children:[Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("div",{children:"Email"}),Object(b.jsx)("input",{type:"text",className:"form-control",id:"emailField",name:"email",onChange:p.handleChange,value:p.values.email,"aria-label":"email-field"}),p.errors.email?Object(b.jsx)(S,{id:"emailError",message:p.errors.email}):null]}),Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("label",{htmlFor:"pswField",children:"Password"}),Object(b.jsx)("input",{type:"password",className:"form-control",id:"pswField",name:"password",onChange:p.handleChange,value:p.values.password,"aria-label":"password-field"}),p.errors.password?Object(b.jsx)(S,{id:"emailError",message:p.errors.password}):null]}),Object(b.jsx)("button",{type:"submit",className:"btn btn-secondary",id:"submitBtn","aria-label":"login-button",children:"Login"})]}),Object(b.jsx)("br",{}),j&&Object(b.jsx)(E.a,{variant:"danger",children:x})]})})}function k(){var e=Object(n.useContext)(m),t=e.state,a=e.actions,s=Object(N.a)({initialValues:{amount:0},onSubmit:function(e){var t=parseFloat(e.amount);a.deposit(t),a.setSuccess(!0),setTimeout((function(){a.setSuccess(!1)}),3e3)},validate:function(e){var t={};return e.amount&&""!==e.amount||(t.amount="Field required"),""!==e.amount&&isNaN(parseFloat(e.amount))&&(t.amount="Just Numbers allowed"),e.amount<0&&(t.amount="Negative Numbers not allowed"),t}});return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("h3",{children:"DEPOSIT"}),Object(b.jsx)(f,{bgcolor:"secondary",body:Object(b.jsxs)(b.Fragment,{children:[t.currentUser&&Object(b.jsx)("form",{onSubmit:s.handleSubmit,"data-testid":"deposit-form",children:Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsxs)("div",{className:"row",children:[Object(b.jsx)("div",{className:"col",children:"Balance: "}),Object(b.jsx)("div",{className:"col","data-testid":"user-balance",children:t.currentUser.balance})]}),Object(b.jsxs)("div",{className:"amount-container",children:[Object(b.jsx)("div",{className:"row",children:Object(b.jsx)("h4",{children:"Deposit Amount"})}),Object(b.jsxs)("div",{className:"fields",children:[Object(b.jsx)("input",{type:"text",className:"form-control",id:"amountField",name:"amount",onChange:s.handleChange,value:s.values.amount,"aria-label":"deposit-field"}),s.errors.amount?Object(b.jsx)(S,{id:"emailError",message:s.errors.amount}):null,Object(b.jsx)("button",{type:"submit",className:"btn btn-primary",id:"submitBtn",disabled:!(s.isValid&&s.dirty),children:"Deposit"})]})]})]})}),!t.currentUser&&Object(b.jsx)("div",{children:"You can't see this content without being logged in."})]})}),t.success&&Object(b.jsx)("div",{className:"alert alert-success",role:"alert",children:"Succes!"})]})}function F(){var e=Object(n.useContext)(m),t=e.state,a=e.actions,s=Object(N.a)({initialValues:{amount:0},onSubmit:function(e){if(console.log(e),e.amount<=t.currentUser.balance){var n=parseFloat(e.amount);a.withdraw(n),a.setSuccess(!0),setTimeout((function(){a.setSuccess(!1)}),3e3)}else a.setError(!0),setTimeout((function(){a.setError(!1)}),3e3)},validate:function(e){var t={};return e.amount&&""!==e.amount||(t.amount="Field required"),""!==e.amount&&isNaN(parseFloat(e.amount))&&(t.amount="Just Numbers allowed"),e.amount<0&&(t.amount="Negative Numbers not allowed"),t}});return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("h3",{children:"WITHDRAW"}),Object(b.jsx)(f,{bgcolor:"secondary",body:Object(b.jsxs)(b.Fragment,{children:[t.currentUser&&Object(b.jsx)("form",{onSubmit:s.handleSubmit,"data-testid":"withdraw-form",children:Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsxs)("div",{className:"row",children:[Object(b.jsx)("div",{className:"col",children:"Balance: "}),Object(b.jsx)("div",{className:"col","data-testid":"user-balance",children:t.currentUser.balance})]}),Object(b.jsxs)("div",{className:"amount-container",children:[Object(b.jsx)("div",{className:"row",children:Object(b.jsx)("h4",{children:"Withdraw Amount"})}),Object(b.jsxs)("div",{className:"fields",children:[Object(b.jsx)("input",{type:"text",className:"form-control",id:"amountField",name:"amount",onChange:s.handleChange,value:s.values.amount,"aria-label":"withdraw-field"}),s.errors.amount?Object(b.jsx)(S,{id:"emailError",message:s.errors.amount}):null,Object(b.jsx)("button",{type:"submit",className:"btn btn-primary",id:"submitBtn",disabled:!(s.isValid&&s.dirty),children:"Withdraw"})]})]})]})}),!t.currentUser&&Object(b.jsx)("div",{children:"You can't see this content without being logged in."})]})}),t.success&&Object(b.jsx)("div",{className:"alert alert-success",role:"alert",children:"Succes!"}),t.error&&Object(b.jsx)(S,{message:"transaction failed"})]})}function A(){var e=Object(n.useContext)(m),t=e.state,a=e.actions;return Object(n.useEffect)((function(){a.getAllUsers()}),[]),Object(b.jsxs)("table",{className:"table",children:[Object(b.jsx)("thead",{children:Object(b.jsxs)("tr",{children:[Object(b.jsx)("th",{scope:"col",children:"Email"}),Object(b.jsx)("th",{scope:"col",children:"Name"}),Object(b.jsx)("th",{scope:"col",children:"Password"}),Object(b.jsx)("th",{scope:"col",children:"Balance"})]})}),Object(b.jsx)("tbody",{children:t.users.map((function(e){return Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{children:e.email}),Object(b.jsx)("td",{children:e.name}),Object(b.jsx)("td",{children:e.password}),Object(b.jsx)("td",{children:e.balance})]},e.email)}))})]})}a(103),a(104);var T=function(){return Object(b.jsx)(v.a,{children:Object(b.jsxs)("div",{className:"container-fluid",children:[Object(b.jsx)(p,{}),Object(b.jsx)(g.a,{path:"/",exact:!0,component:w}),Object(b.jsx)(g.a,{path:"/CreateAccount/",component:U}),Object(b.jsx)(g.a,{path:"/login/",component:C}),Object(b.jsx)(g.a,{path:"/deposit/",component:k}),Object(b.jsx)(g.a,{path:"/withdraw/",component:F}),Object(b.jsx)(g.a,{path:"/alldata/",component:A})]})})},R=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,109)).then((function(t){var a=t.getCLS,n=t.getFID,s=t.getFCP,c=t.getLCP,r=t.getTTFB;a(e),n(e),s(e),c(e),r(e)}))};r.a.render(Object(b.jsx)(x,{children:Object(b.jsx)(T,{})}),document.getElementById("root")),R()},75:function(e,t,a){}},[[105,1,2]]]);
//# sourceMappingURL=main.a476196a.chunk.js.map